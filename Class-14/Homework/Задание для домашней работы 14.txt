Задание направлено на освоение техники детерминистической интерполяции по
нерегулярно расположенным точкам в среде R. В задании необходимо различными
методами построить поле распределения биомассы зоопланктона в Охотском море по
информации, полученной из базы данных NASA COPEPOD (Coastal & Oceanic Plankton
Ecology, Production, & Observation Database) за 1949-1951 гг.

Пример результирующей карты: файл interp_1.png (метод Акимы).

Слои карты:
— поле распределения биомассы зоопланктона в летние месяцы (июнь-август) на
глубинах 0-200 м по данным экспедиций 1949-1951 гг.
— изолинии с заданным шагом
— точки исходных данных
— суша (серым цветом)

Математическая основа карты:
— проекция: цилиндрическая равнопромежуточная (equidistant cylindrical)
— градусная сетка: присутствует
— масштабная линейка: присутствует

Исходная информация:
1. Файл copepod__b400-compilation.txt с данными по суммарной биомассе
зоопланктона с портала COPEPOD (ссылка #1 в конце задания). Для загрузки нажмите
VIEW/DOWNLOAD в центре страницы (правой кнопкой мыши — сохранить как...).
2. Набор файлов World_Seas_IHO_v3 с границами морей Международной
гидрографической организации с портала Marine Regions (ссылка #2 в конце
задания). Вам нужен набор данных IHO Sea Areas > Version 3 (2018). При
скачивании необходимо заполнить краткую форму.
3. Полигон суши (land) масштаба 1:50М из базы данных Natural Earth (загружается
через пакет rnaturalearth)

Подготовка к выполнению:
1. Создайте проект RStudio в новой папке и в нем — документ R Markdown, в
котором вы будете писать отчет и выполнять вычисления.
2. Скачайте исходные файлы, и не переименовывая их, положите в папку проекта
3. Ознакомьтесь со структурой файла по биомассе в текстовом редакторе (это
понадобится для настройки функции чтения).

Порядок вычислений:
0. Подключите все необходимые библиотеки
1. Произведите чтение входных данных.
2. Отфильтруйте таблицу морей, чтобы оставить в ней только Охотское море
3. Отфильтруйте таблицу биомассы так, чтобы остались точки:
— координаты которых в полях LONGITDE и LATITUDE попадают в ограничивающий
прямоугольник Охотского моря;
— у которых нижняя граница наблюдений (LOWER_Z) располагается на глубже 200 м;
— которые относятся к летним месяцам (6-8)
— которые попадают в промежуток годов 1949-1951.
4. Превратите отфильтрованные точки в объекты sf и выполните их точную выборку в
пределах полигона Охотского моря.
5. Перепроецируйте точки, полигон моря и сушу в цилиндрическую
равнопромежуточную проекцию.
6. Выполните построение регулярной сетки типа stars для интерполяции. Сетка
должна покрывать Охотское море (перепроецированное!) целиком с шагом 10 км по
обоим направлениям.
7. Для каждого из нижеперечисленных методов интерполяции последовательно:
— Выполните интерполяцию биомассы зоопланктона на единицу объема воды
(переменная VALUE-per-volu — её желательно перед интерполяцией переименовать,
дав более лаконичное название) и запишите результат в построенную сетку под
соответствующим названием (используйте mutate).
— Постройте изолинии с заданным шагом.
— Визуализируйте полученное распределение в виде карты средствами ggplot2.

Файл R Markdown необходимо разбить на несколько блоков кода, соответствующих
подключению библиотек, чтению данных, подготовке данных, интерполяции и
визуализации. В конце файла должен содержаться краткий анализ полученных
результатов, включающий сравнение методов.

Методы интерполяции:
— Интерполяция на основе триангуляции (метод Акимы)
— Интерполяция методом обратно взвешенных расстояний (степень 2)
— Интерполяция методом радиальных базисных функций (сплайны с натяжением).
ВНИМАНИЕ: при использовании этого метода в функции Tps(...) надо указать
параметр lambda = 0, иначе он будет работать как сглаживающий.

Подсказки:
— при чтении шейп-файла средствами st_read() необходимо указывать файл с
расширением *.shp. Остальные файлы ни в коем случае удалять нельзя!
— для фильтрации таблицы по координатам (шаг 5) извлеките ограничивающий
прямоугольник моря с помощью st_bbox() и используйте значения его координат в
функции filter() по соответствующим полям.
— при обрезке входных точек и сетки контуром моря используйте синтаксис
pts[sea, ] или pts[sea] в зависимости от того, являются точки объектом типа sf
или sfc. Не используйте функцию st_intersection(), поскольку она предназначена
для других задач и работает существенно медленнее.
— для рисования координатной сетки поверх объектов постройте ее сначала,
используя функцию st_graticule().
— масштабную линейку можно построить, используя функцию annotation_scale() из
пакета ggspatial.
— сноска, располагающаяся в правом нижнем углу, может быть построена с помощью
labs(caption = ...).

Требования к коду:
— соблюдение общепринятого стиля программирования,
— осмысленные названия переменных (только латиница),
— минимизация количества промежуточных переменных и активное использование
конвейера манипуляций
— комментарии в ключевых местах
— редактировать входные данные и названия файлов нельзя
— вся исходная информация содержится в каталоге проекта


Форма представления:
— документ R Markdown, названный латиницей по шаблону 13_Фамилия.Rmd (например,
13_Samsonov.Rmd)


Ссылки:
1. https://www.st.nmfs.noaa.gov/copepod/atlas/html/taxatlas_b400.html
2. http://www.marineregions.org/downloads.php
